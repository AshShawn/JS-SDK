!function(){function e(){}function n(n,t,r){function i(){c.parentNode&&c.parentNode.removeChild(c),window[p]=e,d&&clearTimeout(d)}function a(){window[p]&&i()}"function"==typeof t&&(r=t,t={}),t||(t={});var c,d,u=t.prefix||"callback",p=t.name||u+o++,m=t.param||"callback",s=null!=t.timeout?t.timeout:6e4,f=encodeURIComponent,l=document.getElementsByTagName("script")[0]||document.head;return s&&(d=setTimeout(function(){i(),r&&r(new Error("Timeout"))},s)),window[p]=function(e){i(),r&&r(null,e)},n+=(~n.indexOf("?")?"&":"?")+m+"="+f(p)+"&_="+(new Date).getTime(),n=n.replace("?&","?"),c=document.createElement("script"),c.src=n,l.parentNode.insertBefore(c,l),a}function t(e){e||alert("初始化OneNetApi时必须传入apiKey！"),this._apiKey=encodeURIComponent(e)}var o=1,r="http://open.iot.10086.cn";t.prototype={getDataStreams:function(e){var t;return n(r+"/api/jsonpresend?key="+this._apiKey+"&method=GET&uri=devices/"+e+"/datastreams",function(e,n){(e||!n.hasOwnProperty("data"))&&(n={errno:100,error:"timeout"}),t&&t(n)}),{done:function(e){t=e}}},getDataPoints:function(e,t){var o,i="devices/"+e+"/datapoints?";if(t)for(var a in t)i+="&"+a+"="+encodeURIComponent(t[a]);return i=i.replace("?&","?"),n(r+"/api/jsonpresend?key="+this._apiKey+"&method=GET&uri="+i,function(e,n){(e||!n.hasOwnProperty("data"))&&(n={errno:100,error:"timeout"}),o&&o(n)}),{done:function(e){o=e}}},sendCommand:function(e,t){var o;return n(r+"/api/jsonpresend?key="+this._apiKey+"&method=cmds&uri=cmds&device_id="+e+"&sms="+encodeURIComponent(t),function(e,n){(e||!n.hasOwnProperty("errno"))&&(n={errno:100,error:"timeout"}),o&&o(n)}),{done:function(e){o=e}}}},window.OneNetApi=t}();