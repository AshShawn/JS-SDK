!function(){function e(){}function n(n,t,r){function i(){c.parentNode&&c.parentNode.removeChild(c),window[m]=e,u&&clearTimeout(u)}function a(){window[m]&&i()}"function"==typeof t&&(r=t,t={}),t||(t={});var c,u,d=t.prefix||"callback",m=t.name||d+o++,p=t.param||"callback",s=null!=t.timeout?t.timeout:6e4,f=encodeURIComponent,w=document.getElementsByTagName("script")[0]||document.head;return s&&(u=setTimeout(function(){i(),r&&r(new Error("Timeout"))},s)),window[m]=function(e){i(),r&&r(null,e)},n+=(~n.indexOf("?")?"&":"?")+p+"="+f(m)+"&_="+(new Date).getTime(),n=n.replace("?&","?"),c=document.createElement("script"),c.src=n,w.parentNode.insertBefore(c,w),a}function t(e){e||alert("初始化OneNetApi时必须传入apiKey！"),this._apiKey=e}var o=1;t.prototype={getDataStreams:function(e){var t;return n("http://www.onenetv2.com/api/jsonpresend?key="+this._apiKey+"&method=GET&uri=devices/"+e+"/datastreams",function(e,n){(e||!n.hasOwnProperty("data"))&&(n={errno:100,error:"timeout"}),t&&t(n)}),{done:function(e){t=e}}},getDataPoints:function(e,t){var o,r="cmds";if(t)for(var i in t)r+="&"+i+"="+t[i];return r=r.replace("?&","?"),n("http://www.onenetv2.com/api/jsonpresend?key="+this._apiKey+"&method=GET&uri="+encodeURIComponent(r),function(e,n){(e||!n.hasOwnProperty("data"))&&(n={errno:100,error:"timeout"}),o&&o(n)}),{done:function(e){o=e}}},sendCommand:function(e,t){var o;return n("http://www.onenetv2.com/api/jsonpresend?key="+this._apiKey+"&method=cmds&uri=cmds&device_id="+e+"&sms="+encodeURIComponent(t),function(e,n){(e||!n.hasOwnProperty("errno"))&&(n={errno:100,error:"timeout"}),o&&o(n)}),{done:function(e){o=e}}}},window.OneNetApi=t}();